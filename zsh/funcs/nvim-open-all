#!/usr/bin/env zsh

# Open all non-binary files in current directory (skip common junk)
command -v fd &>/dev/null || return

local -a files=()
while IFS= read -r -d '' f; do
  file -bi "$f" | grep -vq binary && files+=("$f")
done < <(fd -HItf \
  --exclude .git \
  --exclude .github \
  --exclude __pycache__ \
  --exclude Session.vim \
  --exclude .venv \
  --exclude "Icon?" \
  --exclude "*.pdf" \
  -0)

((${#files[@]})) && "$EDITOR" "${files[@]}"
